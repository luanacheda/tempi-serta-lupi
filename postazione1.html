<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sede Lupi - Serta Lupi</title>

    <style>
        /* Applica il font Segoe UI a tutto il sito */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }

        /* Tabella che si adatta allo schermo */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px auto;
        }

        th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: center;
        }

        button {
            padding: 5px 10px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }

        button:hover {
            background-color: #218838;
        }

        .controls {
            text-align: center;
            margin: 20px;
        }

        /* Media query per schermi piccoli (ad esempio telefoni) */
        @media (max-width: 768px) {
            th, td {
                width: auto; /* Larghezza automatica per adattarsi a schermi piccoli */
                font-size: 14px; /* Riduce la dimensione del testo */
                padding: 8px; /* Riduce l'imbottitura */
            }

            button {
                padding: 5px 8px; /* Ridimensiona i bottoni per adattarsi meglio allo schermo */
                font-size: 12px; /* Font pi√π piccolo per i bottoni */
            }

            h1 {
                font-size: 18px; /* Riduce la dimensione del titolo su schermi piccoli */
            }

            table {
                font-size: 12px; /* Riduce la dimensione complessiva della tabella */
            }
        }
    </style>
</head>
<body>
    <h1>Sede Lupi - Decodifica e partenza discesista</h1>

    <table id="time-table">
        <tr>
            <th>Sestena</th>
            <th>Inizio decodifica</th>
            <th>Fine decodifica</th>
            <th>Partenza discesista</th>
        </tr>
        <tr>
            <td>01</td>
            <td id="time-squadra-1"><button onclick="recordStartTime(1)">Via!</button></td>
            <td id="time-squadra-2"><button onclick="recordStartTime(2)">Stop</button></td>
            <td id="time-squadra-3"><button onclick="recordStartTime(3)">Via!</button></td>
        </tr>
        <tr>
            <td>02</td>
            <td id="time-squadra-4"><button onclick="recordStartTime(4)">Via!</button></td>
            <td id="time-squadra-5"><button onclick="recordStartTime(5)">Stop</button></td>
            <td id="time-squadra-6"><button onclick="recordStartTime(6)">Via!</button></td>
        </tr>
        <!-- Aggiungi altre righe... -->
    </table>

    <div class="controls">
        <button onclick="resetTimes()">Resetta Tempi</button>
        <button onclick="exportTable()">Esporta Tabella</button>
    </div>

    <script>
        function recordStartTime(team) {
            const currentTime = new Date().toLocaleTimeString();
            document.getElementById('time-squadra-' + team).innerHTML = currentTime;
            saveTime(team, currentTime);
        }

        function saveTime(team, time) {
            let savedTimes = JSON.parse(localStorage.getItem('savedTimes')) || {};
            savedTimes['time-squadra-' + team] = time;
            localStorage.setItem('savedTimes', JSON.stringify(savedTimes));
        }

        function loadSavedTimes() {
            let savedTimes = JSON.parse(localStorage.getItem('savedTimes')) || {};
            for (let key in savedTimes) {
                if (savedTimes.hasOwnProperty(key)) {
                    document.getElementById(key).innerHTML = savedTimes[key];
                }
            }
        }

        function resetTimes() {
            if (confirm("Sei sicuro di voler resettare tutti i tempi?")) {
                localStorage.removeItem('savedTimes');
                location.reload();
            }
        }

        function exportTable() {
            let table = document.getElementById("time-table");
            let rows = table.rows;
            let csvContent = "";

            for (let i = 0; i < rows.length; i++) {
                let row = [];
                let cols = rows[i].querySelectorAll("td, th");
                for (let j = 0; j < cols.length; j++) {
                    row.push(cols[j].innerText);
                }
                csvContent += row.join(",") + "\n";
            }

            let blob = new Blob([csvContent], { type: 'text/csv' });
            let link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'tempi_staffetta.csv';
            link.click();
        }

        window.onload = loadSavedTimes;
    </script>
</body>
</html>
